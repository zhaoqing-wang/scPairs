% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/find_gene_pairs.R
\name{FindGenePairs}
\alias{FindGenePairs}
\title{Find Synergistic Partners for a Given Gene}
\usage{
FindGenePairs(
  object,
  gene,
  candidates = NULL,
  n_top_genes = 2000,
  assay = NULL,
  slot = "data",
  cluster_col = NULL,
  cor_method = c("pearson", "spearman", "biweight"),
  n_mi_bins = 5,
  min_cells_expressed = 10,
  use_prior = TRUE,
  organism = "mouse",
  custom_pairs = NULL,
  use_neighbourhood = TRUE,
  neighbourhood_k = 20,
  neighbourhood_reduction = "pca",
  smooth_alpha = 0.3,
  use_spatial = TRUE,
  spatial_k = 6,
  n_perm = 0,
  weights = NULL,
  top_n = NULL,
  verbose = TRUE
)
}
\arguments{
\item{object}{A Seurat object.}

\item{gene}{Character; the query gene name.}

\item{candidates}{Character vector of candidate partner genes.  NULL =
auto-select from \code{VariableFeatures} or top-expressed genes.}

\item{n_top_genes}{Integer; max candidates when \code{candidates = NULL}.}

\item{assay}{Character; assay name.}

\item{slot}{Character; data slot.}

\item{cluster_col}{Character; cluster column in meta.data (NULL = Idents).}

\item{cor_method}{Correlation methods to use.}

\item{n_mi_bins}{Bins for mutual information.}

\item{min_cells_expressed}{Minimum cells co-expressing both genes.}

\item{use_prior}{Logical; if TRUE, compute GO/KEGG prior knowledge scores
and bridge gene analysis. Default TRUE.}

\item{organism}{Character; "mouse" or "human". Used for GO/KEGG annotation
lookup when \code{use_prior = TRUE}.}

\item{custom_pairs}{Optional data.frame with columns \code{gene_a} and \code{gene_b}
providing custom interaction pairs (e.g., from CellChatDB, CellPhoneDB,
SCENIC regulons).}

\item{use_neighbourhood}{Logical; compute neighbourhood-aware metrics
(KNN-smoothed correlation and neighbourhood co-expression score).}

\item{neighbourhood_k}{Integer; number of nearest neighbours for the
neighbourhood graph. Default 20.}

\item{neighbourhood_reduction}{Character; reduction to use for building the
neighbourhood graph. Default "pca".}

\item{smooth_alpha}{Numeric in [0,1]; self-weight for KNN smoothing.
0 = pure neighbour average, 1 = no smoothing. Default 0.3.}

\item{use_spatial}{Logical; compute spatial metrics if available.}

\item{spatial_k}{Integer; neighbourhood size for spatial metrics.}

\item{n_perm}{Integer; permutations for p-values.}

\item{weights}{Named numeric; metric weights.}

\item{top_n}{Integer; return only top partners.}

\item{verbose}{Logical.}
}
\value{
A list with class \code{"scPairs_gene_result"}:
\describe{
\item{\code{query_gene}}{The input gene.}
\item{\code{pairs}}{\code{data.table} of partners ranked by synergy score.}
\item{\code{parameters}}{Analysis parameters.}
\item{\code{n_candidates}}{Number of candidate genes tested.}
\item{\code{n_cells}}{Number of cells.}
\item{\code{has_spatial}}{Logical.}
}
}
\description{
Given a gene of interest, \code{FindGenePairs} identifies and ranks all genes
that act synergistically with it.  The function uses the same multi-evidence
framework as \code{\link[=FindAllPairs]{FindAllPairs()}} but focuses computation on pairs involving the
query gene, making it much faster for targeted queries.
}
\details{
\strong{Performance (v0.1.1):} Pearson and Spearman correlations for the query
gene against all candidates are computed via a single vectorised matrix
multiply instead of per-candidate loops.  The co-expression filter uses
a vectorised matrix operation.  Biweight midcorrelation, mutual information,
and ratio consistency are computed using batch-optimised helpers where
possible.
}
\examples{
\dontrun{
# Find top 20 partners for TP53
result <- FindGenePairs(seurat_obj, gene = "TP53", top_n = 20)
head(result$pairs)
PlotPairNetwork(result)
}

}
