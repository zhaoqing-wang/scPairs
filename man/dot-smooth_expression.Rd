% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/neighbourhood.R
\name{.smooth_expression}
\alias{.smooth_expression}
\title{Smooth expression vectors using a KNN weight matrix}
\usage{
.smooth_expression(mat, W, alpha = 0.3)
}
\arguments{
\item{mat}{Expression matrix (genes x cells).}

\item{W}{Sparse weight matrix (n_cells x n_cells), row-standardised.}

\item{alpha}{Numeric in [0, 1]; self-weight. Default 0.3.}
}
\value{
Smoothed expression matrix (same dimensions).
}
\description{
For each cell, the smoothed expression is a weighted average of its
neighbours' expression values:
\deqn{\tilde{x}_i = \alpha \cdot x_i + (1 - \alpha) \cdot \sum_{j \in N(i)} w_{ij} x_j}
}
\keyword{internal}
