% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/assess_pair.R
\name{AssessGenePair}
\alias{AssessGenePair}
\title{Assess the Synergy of a Specific Gene Pair}
\usage{
AssessGenePair(
  object,
  gene1,
  gene2,
  assay = NULL,
  slot = "data",
  cluster_col = NULL,
  use_prior = TRUE,
  organism = "mouse",
  custom_pairs = NULL,
  use_neighbourhood = TRUE,
  neighbourhood_k = 20,
  neighbourhood_reduction = "pca",
  smooth_alpha = 0.3,
  use_spatial = TRUE,
  spatial_k = 6,
  n_perm = 999,
  verbose = TRUE
)
}
\arguments{
\item{object}{A Seurat object.}

\item{gene1}{Character; first gene.}

\item{gene2}{Character; second gene.}

\item{assay}{Character; assay name.}

\item{slot}{Character; data slot.}

\item{cluster_col}{Character; cluster column.}

\item{use_prior}{Logical; if TRUE, compute GO/KEGG prior knowledge scores
and bridge gene analysis. Default TRUE.}

\item{organism}{Character; "mouse" or "human". Used for GO/KEGG annotation
lookup when \code{use_prior = TRUE}.}

\item{custom_pairs}{Optional data.frame with columns \code{gene_a} and \code{gene_b}
providing custom interaction pairs (e.g., from CellChatDB, CellPhoneDB,
SCENIC regulons).}

\item{use_neighbourhood}{Logical; compute neighbourhood-aware metrics
(KNN-smoothed correlation and neighbourhood co-expression score).}

\item{neighbourhood_k}{Integer; number of nearest neighbours for the
neighbourhood graph. Default 20.}

\item{neighbourhood_reduction}{Character; reduction to use for building the
neighbourhood graph. Default "pca".}

\item{smooth_alpha}{Numeric in [0,1]; self-weight for KNN smoothing.
0 = pure neighbour average, 1 = no smoothing. Default 0.3.}

\item{use_spatial}{Logical.}

\item{spatial_k}{Integer; KNN k.}

\item{n_perm}{Integer; number of permutations (default 999).}

\item{verbose}{Logical.}
}
\value{
A list with class \code{"scPairs_pair_result"}:
\describe{
\item{\code{gene1}, \code{gene2}}{The query genes.}
\item{\code{metrics}}{Named list of all computed metrics.}
\item{\code{per_cluster}}{data.frame of per-cluster correlations.}
\item{\code{synergy_score}}{Composite score.}
\item{\code{p_value}}{Permutation p-value.}
\item{\code{confidence}}{Categorical confidence label.}
\item{\code{jaccard_index}}{Expression overlap Jaccard index.}
\item{\code{has_spatial}}{Logical.}
\item{\code{n_cells}}{Integer.}
}
}
\description{
Given two genes, \code{AssessGenePair} performs an in-depth evaluation of their
co-regulatory relationship.  In addition to the standard multi-metric
scoring, it computes:
\itemize{
\item \strong{Per-cluster co-expression} -- correlation within each cell cluster,
revealing whether synergy is global or cluster-specific.
\item \strong{Expression distribution overlap} -- Jaccard index of the sets of cells
expressing each gene.
\item \strong{Permutation-based significance} -- by default 999 permutations are run
to produce a robust p-value.
}

For spatial data, spatial metrics (Lee's L, CLQ) are also computed.
}
\details{
\strong{Performance (v0.1.1):} The permutation loop now pre-generates all
permuted y-vectors as a matrix and uses vectorised correlation, biweight,
MI, and ratio consistency computations.  Pearson and Spearman correlations
for all permutations are computed via a single matrix multiply.
}
\examples{
\dontrun{
result <- AssessGenePair(seurat_obj, gene1 = "CD8A", gene2 = "CD8B")
print(result)

# Visualise
PlotPairDimplot(seurat_obj, gene1 = "CD8A", gene2 = "CD8B")
PlotPairScatter(seurat_obj, gene1 = "CD8A", gene2 = "CD8B")
}

}
