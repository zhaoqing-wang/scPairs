% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/find_all_pairs.R
\name{FindAllPairs}
\alias{FindAllPairs}
\title{Discover All Synergistic Gene Pairs}
\usage{
FindAllPairs(
  object,
  features = NULL,
  n_top_genes = 2000,
  assay = NULL,
  slot = "data",
  cluster_col = NULL,
  mode = c("all", "expression", "prior_only"),
  cor_method = c("pearson", "spearman", "biweight"),
  n_mi_bins = 5,
  min_cells_expressed = 10,
  use_prior = TRUE,
  organism = "mouse",
  custom_pairs = NULL,
  use_neighbourhood = TRUE,
  neighbourhood_k = 20,
  neighbourhood_reduction = "pca",
  smooth_alpha = 0.3,
  use_spatial = TRUE,
  spatial_k = 6,
  n_perm = 0,
  weights = NULL,
  top_n = NULL,
  verbose = TRUE
)
}
\arguments{
\item{object}{A Seurat object (scRNA-seq or spatial).}

\item{features}{Character vector of gene names to consider.
NULL (default) uses Seurat \code{VariableFeatures}; if unavailable, selects
the top \code{n_top_genes} by mean expression.}

\item{n_top_genes}{Integer; maximum number of genes to analyse when
\code{features = NULL}.  Default 2000.}

\item{assay}{Character; assay to use.  Default: \code{DefaultAssay(object)}.}

\item{slot}{Character; data slot.  Default \code{"data"} (log-normalised).}

\item{cluster_col}{Character; column in \code{meta.data} with cluster IDs.
NULL = use \code{Idents(object)}.}

\item{mode}{Character; \code{"all"}, \code{"expression"}, or \code{"prior_only"}.}

\item{cor_method}{Character vector; correlation methods to compute.
Default \code{c("pearson", "spearman", "biweight")}.}

\item{n_mi_bins}{Integer; bins for mutual information.  0 = skip MI.}

\item{min_cells_expressed}{Integer; minimum co-expressing cells to keep a
pair.  Default 10.}

\item{use_prior}{Logical; integrate prior knowledge (GO/KEGG).  Default TRUE.}

\item{organism}{Character; \code{"mouse"} or \code{"human"}.}

\item{custom_pairs}{Optional data.frame with columns \code{gene1}, \code{gene2}.}

\item{use_neighbourhood}{Logical; compute neighbourhood-aware metrics.
Default TRUE.}

\item{neighbourhood_k}{Integer; KNN k.  Default 20.}

\item{neighbourhood_reduction}{Character; reduction for KNN.  Default \code{"pca"}.}

\item{smooth_alpha}{Numeric in [0,1]; self-weight for KNN smoothing.}

\item{use_spatial}{Logical; compute spatial metrics when available.}

\item{spatial_k}{Integer; spatial KNN k.}

\item{n_perm}{Integer; permutations for p-values.  0 = skip.}

\item{weights}{Named numeric; metric weights for score integration.}

\item{top_n}{Integer or NULL; return only top \emph{n} pairs.}

\item{verbose}{Logical.}
}
\value{
A list with class \code{"scPairs_result"} containing:
\describe{
\item{\code{pairs}}{\code{data.table} of gene pairs with all metric columns,
\code{synergy_score}, \code{rank}, \code{p_value} (if permutation), \code{p_adj},
\code{confidence}.}
\item{\code{parameters}}{List of analysis parameters.}
\item{\code{n_genes}}{Number of genes analysed.}
\item{\code{n_cells}}{Number of cells.}
\item{\code{has_spatial}}{Logical.}
\item{\code{mode}}{Character; the mode used.}
}
}
\description{
The primary discovery function of \strong{scPairs}.
Given a Seurat object, \code{FindAllPairs} identifies synergistic gene pairs by
integrating multiple lines of evidence: co-expression, neighbourhood
smoothing, prior biological knowledge, and spatial co-variation.
}
\details{
Metrics are rank-normalised and combined via weighted summation.
Optional permutation testing provides empirical p-values.

The \code{mode} parameter controls which metric layers are computed:
\itemize{
\item \code{"all"} (default) -- compute all available metrics.
\item \code{"expression"} -- expression and neighbourhood metrics only (no prior
knowledge).
\item \code{"prior_only"} -- prior knowledge scores only (fast).
}
}
\examples{
\dontrun{
# Default: all metrics
result <- FindAllPairs(seurat_obj, n_top_genes = 500, top_n = 100)

# Expression only (skip prior knowledge)
result <- FindAllPairs(seurat_obj, mode = "expression")

# Prior knowledge only (fast screening)
result <- FindAllPairs(seurat_obj, mode = "prior_only")
}
}
