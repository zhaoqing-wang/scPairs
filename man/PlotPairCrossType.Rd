% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/plot_cross_celltype.R
\name{PlotPairCrossType}
\alias{PlotPairCrossType}
\title{Plot Cross-Cell-Type Interaction Heatmap}
\usage{
PlotPairCrossType(
  object,
  gene1,
  gene2,
  result = NULL,
  assay = NULL,
  slot = "data",
  cluster_col = NULL,
  neighbourhood_k = 20,
  neighbourhood_reduction = "pca",
  min_cross_pairs = 30,
  min_pct_expressed = 0.01,
  show_n = TRUE,
  show_reverse = TRUE,
  diverging = TRUE,
  title = NULL
)
}
\arguments{
\item{object}{A Seurat object.}

\item{gene1}{Character; first gene.}

\item{gene2}{Character; second gene.}

\item{result}{Optional \code{scPairs_pair_result} from
\code{\link{AssessGenePair}}.  If NULL, the pair is assessed internally.}

\item{assay}{Character; assay name.  Default: \code{DefaultAssay(object)}.}

\item{slot}{Character; data slot.  Default \code{"data"}.}

\item{cluster_col}{Character; meta.data column with cell-type labels.
NULL = use \code{Idents(object)}.}

\item{neighbourhood_k}{Integer; k for KNN graph.  Default 20.}

\item{neighbourhood_reduction}{Character; reduction for KNN graph.
Default \code{"pca"}.}

\item{min_cross_pairs}{Integer; minimum cross-type pairs per tile.
Tiles with fewer pairs are greyed out.  Default 30.}

\item{min_pct_expressed}{Numeric; minimum percentage of cells (0-1) in a
cell type that must express a gene. Default 0.01 (1\%). Prevents
spurious correlations with very sparse genes.}

\item{show_n}{Logical; annotate each tile with the number of cross-type
neighbour pairs.  Default TRUE.}

\item{show_reverse}{Logical; if TRUE (default), show a second panel for
the reverse direction (gene2 in source \eqn{\to} gene1 in neighbour).}

\item{diverging}{Logical; use a diverging red--white--blue colour scale
centred at 0.  Default TRUE.}

\item{title}{Character; overall title.  NULL = auto-generated.}
}
\value{
A \code{ggplot} object (or two-panel patchwork if \code{show_reverse = TRUE}).
}
\description{
Visualises the cross-cell-type interaction structure for a gene pair as a
heatmap.  Each tile represents a directed cell-type pair
(source type \eqn{\to} neighbour type), coloured by the Pearson correlation
between gene A expression in the source cells and gene B expression in the
neighbouring cells.

This is the primary visualisation for the trans-cellular synergy metric
introduced in scPairs 0.1.3.  It reveals \emph{which} cell-type interfaces carry
the cross-type signal (e.g. Adora2a in T-cells correlated with Ido1 in
dendritic cells).
}
\examples{
\donttest{
# scpairs_testdata has clusters (seurat_clusters) and PCA already built in.
PlotPairCrossType(scpairs_testdata,
                 gene1 = "GENE3",
                 gene2 = "GENE4")
}

}
