% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/cross_celltype.R
\name{.cross_celltype}
\alias{.cross_celltype}
\title{Cross-cell-type interaction score for a single gene pair}
\usage{
.cross_celltype(x, y, W, cluster_ids, min_cross_pairs = 30)
}
\arguments{
\item{x}{Numeric vector; expression of gene1 (length n_cells).}

\item{y}{Numeric vector; expression of gene2 (length n_cells).}

\item{W}{Sparse KNN weight matrix (n_cells x n_cells).}

\item{cluster_ids}{Factor/integer of cluster assignments.}

\item{min_cross_pairs}{Minimum cross-type pairs for correlation.}
}
\value{
A list with components:
\describe{
\item{\code{score}}{Geometric mean of |r(A->B)| and |r(B->A)|.}
\item{\code{r_ab}}{Pearson r for gene1 in source -> gene2 in neighbour.}
\item{\code{r_ba}}{Pearson r for gene2 in source -> gene1 in neighbour.}
\item{\code{n_cross_pairs}}{Number of cross-type neighbour pairs used.}
\item{\code{per_celltype_pair}}{data.frame of per-celltype-pair results
(only for the single-pair function).}
}
}
\description{
Measures whether gene A expressed in one cell type correlates with gene B
expressed in neighbouring cells of a different type.
}
\keyword{internal}
