% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/prior_knowledge.R
\name{.neighbourhood_synergy_batch}
\alias{.neighbourhood_synergy_batch}
\title{Compute neighbourhood synergy score for gene pairs}
\usage{
.neighbourhood_synergy_batch(mat, pair_dt, W)
}
\arguments{
\item{mat}{Expression matrix (genes x cells).}

\item{pair_dt}{data.table with gene1, gene2.}

\item{W}{KNN weight matrix.}
}
\value{
Numeric vector of neighbourhood synergy scores.
}
\description{
Unlike the existing neighbourhood co-expression score (which measures whether
A- and B-expressing cells tend to share neighbours), this metric explicitly
quantifies \strong{directional} neighbourhood enrichment:
}
\details{
For cells highly expressing gene A (top quartile), is gene B's expression
in their neighbourhood significantly higher than expected?  The score is:

\deqn{NS = \frac{\text{mean neigh expr B for top-A cells}}
                 {\text{mean neigh expr B for all cells}}}

This captures paracrine-like interactions where one gene's product in one
cell influences the expression of another gene in nearby cells.
}
\keyword{internal}
