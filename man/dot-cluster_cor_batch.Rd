% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/neighbourhood.R
\name{.cluster_cor_batch}
\alias{.cluster_cor_batch}
\title{Cluster-level (pseudo-bulk) correlation for gene pairs}
\usage{
.cluster_cor_batch(mat, cluster_ids, pair_dt)
}
\arguments{
\item{mat}{Expression matrix (genes x cells).}

\item{cluster_ids}{Factor of cluster assignments.}

\item{pair_dt}{data.table with gene1, gene2.}
}
\value{
Numeric vector of cluster-level correlations.
}
\description{
Computes the Pearson correlation of cluster-level mean expression.
This captures patterns where two genes tend to be expressed in the same
cell populations, even if they are never co-detected in the same cell.
}
\keyword{internal}
